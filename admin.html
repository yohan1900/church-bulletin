<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì£¼ë³´ ê´€ë¦¬ì - ì—´ë¦°ë¬¸êµíšŒ</title>
    <link rel="icon" type="image/png" href="image/favicon.png" />
    <link rel="stylesheet" href="style.css" />
    <style>
        .admin-container {
            max-width: 1200px;
            margin: 100px auto 50px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .admin-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #73aace;
        }
        
        .form-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #eee;
            border-radius: 4px;
        }
        
        .form-section h3 {
            color: #73aace;
            margin-top: 0;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-group {
            flex: 1;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #4d4d4d;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .worship-order {
            margin-top: 15px;
        }
        
        .order-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 4px;
        }
        
        .order-item input {
            flex: 1;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #73aace;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a8db3;
        }
        
        .btn-secondary {
            background: #feb546;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #e09a35;
        }
        
        .btn-danger {
            background: #ff6863;
            color: white;
        }
        
        .btn-small {
            padding: 5px 15px;
            font-size: 14px;
        }
        
        .announcement-list {
            margin-top: 15px;
        }
        
        .announcement-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }
        
        .announcement-item input {
            flex: 1;
        }
        
        .toggle-section {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #73aace;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <h1>ğŸ“‹ ì£¼ë³´ ê´€ë¦¬ì í˜ì´ì§€</h1>
            <p>ì£¼ë³´ë¥¼ ì‘ì„±í•˜ê³  JSON íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”</p>
        </div>

        <form id="bulletinForm">
            <!-- ê¸°ë³¸ ì •ë³´ -->
            <div class="form-section">
                <h3>ê¸°ë³¸ ì •ë³´</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>ë‚ ì§œ *</label>
                        <input type="date" id="bulletinDate" required />
                    </div>
                    <div class="form-group">
                        <label>ê¶Œ</label>
                        <input type="text" id="volume" value="5" />
                    </div>
                    <div class="form-group">
                        <label>í˜¸</label>
                        <input type="text" id="issue" value="47" />
                    </div>
                    <div class="form-group">
                        <label>íŠ¹ë³„ íƒ€ì´í‹€ (ì„ íƒ)</label>
                        <input type="text" id="title" placeholder="ì˜ˆ: ì¶”ìˆ˜ê°ì‚¬ì£¼ì¼" />
                    </div>
                </div>
            </div>

            <!-- ì£¼ì¼ ë‚® ì˜ˆë°° -->
            <div class="form-section">
                <h3>ì£¼ì¼ ë‚® ì˜ˆë°°</h3>
                <div class="form-group">
                    <label>ì¸ë„ì</label>
                    <input type="text" id="morningLeader" value="ì´ìƒë• ëª©ì‚¬" />
                </div>
                
                <div class="worship-order" id="morningOrder">
                    <!-- ë™ì ìœ¼ë¡œ ì¶”ê°€ë  ì˜ˆë°° ìˆœì„œ -->
                </div>
                
                <button type="button" class="btn btn-secondary btn-small" onclick="addWorshipOrder()">+ ì˜ˆë°° ìˆœì„œ ì¶”ê°€</button>
                
                <h4 style="margin-top: 20px;">ë‹¤ìŒì£¼ì¼ ê¸°ë„ì</h4>
                <div class="form-row">
                    <div class="form-group">
                        <label>1ë¶€ ê¸°ë„</label>
                        <input type="text" id="nextPrayer1" />
                    </div>
                    <div class="form-group">
                        <label>2ë¶€ ê¸°ë„</label>
                        <input type="text" id="nextPrayer2" />
                    </div>
                </div>
            </div>

            <!-- ì£¼ì¼ ë°¤ ì˜ˆë°° -->
            <div class="form-section">
                <div class="toggle-section">
                    <h3>ì£¼ì¼ ë°¤ ì˜ˆë°°</h3>
                    <label class="toggle-switch">
                        <input type="checkbox" id="eveningEnabled" />
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div id="eveningContent" style="display:none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label>ê¸°ë„</label>
                            <input type="text" id="eveningPrayer" />
                        </div>
                        <div class="form-group">
                            <label>ë‹¤ìŒ ê¸°ë„</label>
                            <input type="text" id="eveningNextPrayer" />
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>ì„±ê²½</label>
                            <input type="text" id="eveningScripture" />
                        </div>
                        <div class="form-group">
                            <label>ì„¤êµ</label>
                            <input type="text" id="eveningSermon" />
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>ì°¬ì†¡ (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
                            <input type="text" id="eveningHymns" placeholder="ì˜ˆ: 369ì¥, 354ì¥" />
                        </div>
                        <div class="form-group">
                            <label>íŠ¹ì†¡</label>
                            <input type="text" id="eveningSpecial" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- ìˆ˜ìš” ë°¤ ì˜ˆë°° -->
            <div class="form-section">
                <div class="toggle-section">
                    <h3>ìˆ˜ìš” ë°¤ ì˜ˆë°°</h3>
                    <label class="toggle-switch">
                        <input type="checkbox" id="wednesdayEnabled" />
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div id="wednesdayContent" style="display:none;">
                    <div class="form-row">
                        <div class="form-group">
                            <label>ì„±ê²½</label>
                            <input type="text" id="wednesdayScripture" />
                        </div>
                        <div class="form-group">
                            <label>ì„¤êµ</label>
                            <input type="text" id="wednesdaySermon" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- ìƒˆë²½ê¸°ë„íšŒ -->
            <div class="form-section">
                <div class="toggle-section">
                    <h3>ìƒˆë²½ê¸°ë„íšŒ</h3>
                    <label class="toggle-switch">
                        <input type="checkbox" id="dawnEnabled" checked />
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div id="dawnContent">
                    <div class="form-row">
                        <div class="form-group">
                            <label>ì œëª©</label>
                            <input type="text" id="dawnTitle" value="ì–ë³µê°• ê¸°ë„íšŒ" />
                        </div>
                        <div class="form-group">
                            <label>ë‚´ìš©</label>
                            <input type="text" id="dawnContent" placeholder="ì˜ˆ: ì—ìŠ¤ë¼ì„œ ê°•í•´" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì•”ì†¡ë§ì”€ -->
            <div class="form-section">
                <h3>ì•”ì†¡ë§ì”€</h3>
                <div class="form-group">
                    <label>ê°•ì¡° êµ¬ì ˆ (í¬ê²Œ í‘œì‹œë  ë¶€ë¶„)</label>
                    <input type="text" id="verseHighlight" />
                </div>
                <div class="form-group">
                    <label>ë‚˜ë¨¸ì§€ ë‚´ìš©</label>
                    <textarea id="verseContent"></textarea>
                </div>
                <div class="form-group">
                    <label>ì¶œì²˜</label>
                    <input type="text" id="verseReference" placeholder="ì˜ˆ: ì‹œ 119:116" />
                </div>
            </div>

            <!-- êµíšŒì†Œì‹ -->
            <div class="form-section">
                <h3>êµíšŒì†Œì‹</h3>
                <div class="announcement-list" id="announcementList">
                    <!-- ë™ì ìœ¼ë¡œ ì¶”ê°€ë  ê³µì§€ì‚¬í•­ -->
                </div>
                <button type="button" class="btn btn-secondary btn-small" onclick="addAnnouncement()">+ ê³µì§€ ì¶”ê°€</button>
            </div>

            <!-- ë²„íŠ¼ ê·¸ë£¹ -->
            <div class="btn-group">
                <button type="button" class="btn btn-secondary" onclick="loadPreviousBulletin()">ì´ì „ ì£¼ë³´ ë¶ˆëŸ¬ì˜¤ê¸°</button>
                <button type="button" class="btn btn-primary" onclick="previewBulletin()">ë¯¸ë¦¬ë³´ê¸°</button>
                <button type="button" class="btn btn-primary" onclick="downloadBulletin()">ğŸ’¾ JSON ë‹¤ìš´ë¡œë“œ</button>
            </div>
        </form>
    </div>

    <script>
        let worshipOrderCount = 0;
        let announcementCount = 0;

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ ì˜ˆë°° ìˆœì„œ ì¶”ê°€
        window.onload = function() {
            const defaultOrders = [
                { label: 'ì˜ˆë°°ì˜ ë¶€ë¦„', content: 'ì¸ë„ì' },
                { label: 'ì°¬ì†¡', content: '14ì¥' },
                { label: 'ì‹ ì•™ê³ ë°±', content: 'ì‚¬ë„ì‹ ê²½' },
                { label: 'ì°¬ì†¡', content: '400ì¥' },
                { label: 'ê¸°ë„', content: '' },
                { label: 'ì„±ê²½ë´‰ë…', content: '' },
                { label: 'íŠ¹ì†¡', content: 'ë¹„ì „ì°¬ì–‘ëŒ€' },
                { label: 'êµíšŒì†Œì‹', content: 'ì¸ë„ì' },
                { label: 'ë´‰í—Œì°¬ì†¡', content: '' },
                { label: 'ë´‰í—Œê¸°ë„', content: 'ë‹´ì„ëª©ì‚¬' },
                { label: 'ì„¤êµ', content: '' },
                { label: 'ííšŒì†¡', content: '' },
                { label: 'ì¶•ë„', content: 'ë‹´ì„ëª©ì‚¬' }
            ];
            
            defaultOrders.forEach(order => {
                addWorshipOrder(order.label, order.content);
            });
            
            // ê¸°ë³¸ ê³µì§€ 1ê°œ ì¶”ê°€
            addAnnouncement('ì €í¬ êµíšŒì— ì˜¤ì‹  ëª¨ë“  ë¶„ë“¤ì„ ì§„ì‹¬ìœ¼ë¡œ í™˜ì˜í•˜ê³  ì¶•ë³µí•©ë‹ˆë‹¤.');
            
            // ì˜¤ëŠ˜ ë‚ ì§œ ì„¤ì •
            document.getElementById('bulletinDate').valueAsDate = new Date();
        };

        // í† ê¸€ ìŠ¤ìœ„ì¹˜ ì´ë²¤íŠ¸
        document.getElementById('eveningEnabled').addEventListener('change', function() {
            document.getElementById('eveningContent').style.display = this.checked ? 'block' : 'none';
        });
        
        document.getElementById('wednesdayEnabled').addEventListener('change', function() {
            document.getElementById('wednesdayContent').style.display = this.checked ? 'block' : 'none';
        });
        
        document.getElementById('dawnEnabled').addEventListener('change', function() {
            document.getElementById('dawnContent').style.display = this.checked ? 'block' : 'none';
        });

        // ì˜ˆë°° ìˆœì„œ ì¶”ê°€
        function addWorshipOrder(label = '', content = '') {
            const container = document.getElementById('morningOrder');
            const div = document.createElement('div');
            div.className = 'order-item';
            div.innerHTML = `
                <input type="text" placeholder="í•­ëª©ëª… (ì˜ˆ: ì°¬ì†¡)" value="${label}" class="order-label" />
                <input type="text" placeholder="ë‚´ìš© (ì˜ˆ: 14ì¥)" value="${content}" class="order-content" />
                <button type="button" class="btn btn-danger btn-small" onclick="this.parentElement.remove()">ì‚­ì œ</button>
            `;
            container.appendChild(div);
            worshipOrderCount++;
        }

        // ê³µì§€ì‚¬í•­ ì¶”ê°€
        function addAnnouncement(content = '') {
            announcementCount++;
            const container = document.getElementById('announcementList');
            const div = document.createElement('div');
            div.className = 'announcement-item';
            div.innerHTML = `
                <span style="min-width: 30px;">${announcementCount}.</span>
                <input type="text" placeholder="ê³µì§€ì‚¬í•­ ë‚´ìš©" value="${content}" class="announcement-content" />
                <button type="button" class="btn btn-danger btn-small" onclick="removeAnnouncement(this)">ì‚­ì œ</button>
            `;
            container.appendChild(div);
        }

        // ê³µì§€ì‚¬í•­ ì‚­ì œ ë° ë²ˆí˜¸ ì¬ì •ë ¬
        function removeAnnouncement(btn) {
            btn.parentElement.remove();
            const items = document.querySelectorAll('.announcement-item');
            announcementCount = 0;
            items.forEach((item, index) => {
                announcementCount++;
                item.querySelector('span').textContent = (index + 1) + '.';
            });
        }

        // JSON ìƒì„± ë° ë‹¤ìš´ë¡œë“œ
        function downloadBulletin() {
            const bulletinData = collectFormData();
            
            // JSON íŒŒì¼ ìƒì„±
            const blob = new Blob([JSON.stringify(bulletinData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${bulletinData.date}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert(`${bulletinData.date}.json íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\n\ndata/bulletins/ í´ë”ì— ë³µì‚¬í•œ í›„\ndata/bulletins.json íŒŒì¼ì—ë„ ì¶”ê°€í•´ì£¼ì„¸ìš”.`);
        }

        // í¼ ë°ì´í„° ìˆ˜ì§‘
        function collectFormData() {
            const date = document.getElementById('bulletinDate').value;
            const volume = document.getElementById('volume').value;
            const issue = document.getElementById('issue').value;
            const title = document.getElementById('title').value;
            
            // ì˜ˆë°° ìˆœì„œ ìˆ˜ì§‘
            const orderItems = document.querySelectorAll('.order-item');
            const order = [];
            orderItems.forEach(item => {
                const label = item.querySelector('.order-label').value;
                const content = item.querySelector('.order-content').value;
                if (label && content) {
                    order.push({
                        type: label.toLowerCase().replace(/ /g, ''),
                        label: label,
                        content: content
                    });
                }
            });
            
            // ê³µì§€ì‚¬í•­ ìˆ˜ì§‘
            const announcementItems = document.querySelectorAll('.announcement-item');
            const announcements = [];
            announcementItems.forEach((item, index) => {
                const content = item.querySelector('.announcement-content').value;
                if (content) {
                    announcements.push({
                        order: index + 1,
                        content: content
                    });
                }
            });
            
            return {
                date: date,
                volume: volume,
                issue: issue,
                title: title,
                morningWorship: {
                    leader: document.getElementById('morningLeader').value,
                    order: order,
                    nextWeekPrayer: [
                        { part: '1ë¶€ ê¸°ë„', person: document.getElementById('nextPrayer1').value },
                        { part: '2ë¶€ ê¸°ë„', person: document.getElementById('nextPrayer2').value }
                    ],
                    worshipCommittee: {
                        month: '11ì›”',
                        ushers: 'ê³ ìŠ¹ìˆ˜ ì•ˆìˆ˜ì§‘ì‚¬, ì‹ ëª…ìˆœ ê¶Œì‚¬',
                        offering: 'ê¹€ì •ëª… ì§‘ì‚¬, ì´ì •ìˆ™ ê¶Œì‚¬'
                    }
                },
                eveningWorship: {
                    enabled: document.getElementById('eveningEnabled').checked,
                    prayer: document.getElementById('eveningPrayer').value,
                    nextPrayer: document.getElementById('eveningNextPrayer').value,
                    scripture: document.getElementById('eveningScripture').value,
                    sermon: document.getElementById('eveningSermon').value,
                    hymns: document.getElementById('eveningHymns').value.split(',').map(h => h.trim()),
                    special: document.getElementById('eveningSpecial').value
                },
                wednesdayWorship: {
                    enabled: document.getElementById('wednesdayEnabled').checked,
                    scripture: document.getElementById('wednesdayScripture').value,
                    sermon: document.getElementById('wednesdaySermon').value
                },
                dawnPrayer: {
                    enabled: document.getElementById('dawnEnabled').checked,
                    title: document.getElementById('dawnTitle').value,
                    content: document.getElementById('dawnContent').value
                },
                prayerTopics: [
                    "1. ì£¼ë‹˜ì„ ê¸°ì˜ì‹œê²Œ, ì‚¬ëŒì—ê²Œ ì¹­ì°¬ ë“£ëŠ” êµíšŒ.",
                    "2. ì„±ë ¹ì˜ ì„ì¬ë¡œ ì¹˜ìœ ì™€ íšŒë³µ, ë¶€í¥ì„ ì£¼ì†Œì„œ",
                    "3. ë‹¤ìŒ ì„¸ëŒ€ë¥¼ ì„¸ìš°ê²Œ í•˜ì†Œì„œ",
                    "4. ë‚ ë§ˆë‹¤ êµ¬ì›ë°›ëŠ” ìˆ˜ê°€ ë”í•´ê°€ê²Œ í•˜ì†Œì„œ(3-30-300)",
                    "5. ë§ˆì¤‘ë¬¼ì˜ ê¸°ì ì´ ì¼ì–´ë‚˜ê²Œ í•˜ì˜µì†Œì„œ. (ì•„í”„ë¦¬ì¹´ ë°”ì¿¤ì‚¬ êµíšŒ)"
                ],
                memoryVerse: {
                    text: `<span style="font-size: 32px; font-weight: bold; color: #ff6863;">${document.getElementById('verseHighlight').value}</span>`,
                    content: document.getElementById('verseContent').value,
                    reference: document.getElementById('verseReference').value
                },
                announcements: announcements
            };
        }

        // ë¯¸ë¦¬ë³´ê¸°
        function previewBulletin() {
            const data = collectFormData();
            const preview = `
ì œ ${data.volume}ê¶Œ ${data.issue}í˜¸ (${data.date})
${data.title ? 'ã€' + data.title + 'ã€‘' : ''}

ì£¼ì¼ ë‚® ì˜ˆë°° - ${data.morningWorship.leader}
${data.morningWorship.order.map(o => `  ${o.label}: ${o.content}`).join('\n')}

êµíšŒì†Œì‹:
${data.announcements.map(a => `  ${a.order}. ${a.content}`).join('\n')}

ì•”ì†¡ë§ì”€: ${data.memoryVerse.reference}
${document.getElementById('verseHighlight').value}
${data.memoryVerse.content}
            `;
            alert(preview);
        }

        // ì´ì „ ì£¼ë³´ ë¶ˆëŸ¬ì˜¤ê¸° (LocalStorage ì‚¬ìš©)
        function loadPreviousBulletin() {
            alert('ì´ ê¸°ëŠ¥ì€ ì¶”í›„ êµ¬í˜„ ì˜ˆì •ì…ë‹ˆë‹¤.\nì§€ê¸ˆì€ data/bulletins/ í´ë”ì—ì„œ ì´ì „ JSON íŒŒì¼ì„ ìˆ˜ë™ìœ¼ë¡œ ì—´ì–´ ë³µì‚¬í•˜ì‹œë©´ ë©ë‹ˆë‹¤.');
        }
    </script>
</body>
</html>
